<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trợ lý dinh dưỡng Algo - Tư Vấn Dinh Dưỡng Cá Nhân Hóa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Fresh & Vibrant (Lime Green, Bright Orange, Sunny Yellow) -->
    <!-- Application Structure Plan: Một ứng dụng trang đơn được chia thành hai phần chính: một biểu mẫu nhập liệu tương tác theo từng bước và một bảng điều khiển kết quả được tạo động. Người dùng hoàn thành biểu mẫu, sau đó phần kết quả sẽ hiện ra, bao gồm các chỉ số sức khỏe chính (BMI, TDEE), biểu đồ trực quan về phân bổ dinh dưỡng đa lượng, và kế hoạch chi tiết cho 3 bữa ăn hàng ngày. Cấu trúc này hướng dẫn người dùng qua một luồng công việc rõ ràng, từ nhập dữ liệu đến nhận kết quả hữu ích, giúp các lời khuyên dinh dưỡng phức tạp trở nên dễ hiểu. -->
    <!-- Visualization & Content Choices: 
    - Thông tin người dùng -> Mục tiêu: Thu thập dữ liệu -> Trình bày: Biểu mẫu HTML nhiều bước với Tailwind CSS -> Tương tác: Người dùng điền thông tin, chọn tùy chọn -> Lý do: Chia nhỏ việc thu thập dữ liệu thành các bước dễ quản lý, cải thiện trải nghiệm người dùng.
    - Các chỉ số sức khỏe (BMI, TDEE) -> Mục tiêu: Thông báo cho người dùng về tình trạng của họ -> Trình bày: Các "thẻ thống kê" nổi bật với số liệu lớn và nhãn rõ ràng -> Tương tác: Không, chỉ để thông tin -> Lý do: Làm nổi bật ngay lập tức các tính toán quan trọng nhất.
    - Dinh dưỡng đa lượng hàng ngày -> Mục tiêu: Hiển thị sự cân bằng dinh dưỡng -> Trực quan hóa: Biểu đồ Donut từ Chart.js/Canvas -> Tương tác: Di chuột để xem chú giải chi tiết về tỷ lệ phần trăm -> Lý do: Cung cấp một bản tóm tắt nhanh, trực quan về sự cân bằng của kế hoạch bữa ăn, dễ hiểu hơn so với số liệu thô. (NO SVG/Mermaid).
    - Kế hoạch bữa ăn -> Mục tiêu: Cung cấp lời khuyên cụ thể -> Trình bày: Lưới ba cột (xếp chồng trên di động) với các thẻ cho mỗi bữa ăn, không có hình ảnh, chỉ có mô tả văn bản và bảng HTML cho thông tin dinh dưỡng -> Tương tác: Không, chỉ để thông tin -> Lý do: Sắp xếp kết quả chính một cách logic và tập trung vào thông tin. (NO SVG/Mermaid). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB;
            color: #374151;
            background-image: url('https://storage.googleapis.com/aai-web-template-content/Gemini/images/healthy-bep-viet/food_pattern_background_light.png');
            background-size: cover;
            background-attachment: fixed;
        }
        .form-section {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid #E5E7EB;
            padding: 2.5rem;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .btn-primary {
            background-color: #84CC16; /* lime-500 */
            color: white;
            padding: 0.875rem 2rem;
            border-radius: 9999px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .btn-primary:hover {
            background-color: #65A30D; /* lime-600 */
            transform: translateY(-2px);
            box-shadow: 0 7px 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            font-weight: 800;
        }
        .result-card {
            background: #FFFFFF;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #F3F4F6;
        }
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .stat-card {
             background-color: rgba(255, 255, 255, 0.8);
             backdrop-filter: blur(5px);
             padding: 1rem;
             border-radius: 12px;
             border: 1px solid rgba(255,255,255,0.2);
             box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="antialiased">

    <header class="text-center py-10 md:py-16">
        <h1 class="text-5xl md:text-6xl font-extrabold text-lime-600">Trợ lý dinh dưỡng Algo</h1>
        <p class="text-lg mt-4 text-gray-700 max-w-2xl mx-auto">Xây dựng kế hoạch dinh dưỡng cá nhân hóa, khoa học và đậm chất Việt</p>
    </header>

    <main class="container mx-auto px-4 pb-12">
        <section id="form-section" class="max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold text-center mb-4">Bắt đầu hành trình sống khỏe!</h2>
            <p class="text-center text-gray-600 mb-8">Chỉ 1 phút để nhận ngay thực đơn được "may đo" dành riêng cho bạn.</p>
            <form id="nutrition-form">
                <div class="space-y-10">
                    <div>
                        <h3 class="text-xl font-bold border-b-2 border-lime-200 pb-2 mb-6 flex items-center gap-3"><span class="bg-lime-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold">1</span> Thông tin cơ bản</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="age" class="block text-sm font-medium text-gray-700">Tuổi</label>
                                <input type="number" id="age" name="age" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500" placeholder="VD: 30">
                            </div>
                            <div>
                                <label for="gender" class="block text-sm font-medium text-gray-700">Giới tính</label>
                                <select id="gender" name="gender" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500">
                                    <option value="male">Nam</option>
                                    <option value="female">Nữ</option>
                                </select>
                            </div>
                            <div>
                                <label for="height" class="block text-sm font-medium text-gray-700">Chiều cao (cm)</label>
                                <input type="number" id="height" name="height" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500" placeholder="VD: 170">
                            </div>
                            <div>
                                <label for="weight" class="block text-sm font-medium text-gray-700">Cân nặng (kg)</label>
                                <input type="number" id="weight" name="weight" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500" placeholder="VD: 65">
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold border-b-2 border-lime-200 pb-2 mb-6 flex items-center gap-3"><span class="bg-lime-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold">2</span> Tình trạng sức khỏe</h3>
                        <div class="space-y-2">
                             <p class="text-sm text-gray-600 mb-3">Chọn các bệnh lý nền (nếu có). Algo sẽ dựa vào đây để tối ưu thực đơn cho bạn.</p>
                             <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="none" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Không có</span></label></div>
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="diabetes" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Tiểu đường Type 2</span></label></div>
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="hypertension" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Cao huyết áp</span></label></div>
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="lipid" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Rối loạn mỡ máu</span></label></div>
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="obesity" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Béo phì</span></label></div>
                                <div><label class="inline-flex items-center"><input type="checkbox" name="condition" value="gout" class="rounded border-gray-300 text-lime-600 shadow-sm focus:ring-lime-500"> <span class="ml-2">Bệnh Gout</span></label></div>
                             </div>
                        </div>
                    </div>
                    
                    <div>
                         <h3 class="text-xl font-bold border-b-2 border-lime-200 pb-2 mb-6 flex items-center gap-3"><span class="bg-lime-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold">3</span> Lối sống và mục tiêu</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="activity" class="block text-sm font-medium text-gray-700">Mức độ hoạt động</label>
                                <select id="activity" name="activity" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500">
                                    <option value="1.2">Ít vận động (làm việc văn phòng)</option>
                                    <option value="1.375">Vận động nhẹ (tập 1-3 ngày/tuần)</option>
                                    <option value="1.55">Vận động vừa (tập 3-5 ngày/tuần)</option>
                                    <option value="1.725">Vận động nặng (tập 6-7 ngày/tuần)</option>
                                    <option value="1.9">Vận động rất nặng (lao động nặng)</option>
                                </select>
                            </div>
                             <div>
                                <label for="goal" class="block text-sm font-medium text-gray-700">Mục tiêu của bạn</label>
                                <select id="goal" name="goal" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500">
                                    <option value="lose">Giảm cân</option>
                                    <option value="maintain">Duy trì cân nặng</option>
                                    <option value="gain">Tăng cân</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-12 text-center">
                    <button type="submit" class="btn-primary text-lg">Xem Kế Hoạch Dinh Dưỡng Của Tôi</button>
                </div>
            </form>
        </section>

        <section id="results-section" class="hidden mt-16">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold">Kế Hoạch Dinh Dưỡng Dành Cho Bạn</h2>
                    <p id="result-intro" class="mt-3 text-gray-600"></p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 text-center">
                    <div class="stat-card">
                        <h3 class="text-sm font-medium text-gray-500">Chỉ số BMI</h3>
                        <p id="bmi-value" class="text-4xl font-extrabold text-orange-500"></p>
                        <p id="bmi-category" class="text-sm font-semibold text-orange-600"></p>
                    </div>
                    <div class="stat-card">
                        <h3 class="text-sm font-medium text-gray-500">BMR (Năng lượng nghỉ)</h3>
                        <p id="bmr-value" class="text-4xl font-extrabold text-blue-500"></p>
                        <p class="text-sm font-semibold text-blue-600">Năng lượng cơ bản</p>
                    </div>
                    <div class="stat-card">
                        <h3 class="text-sm font-medium text-gray-500">TDEE (Tổng năng lượng)</h3>
                        <p id="tdee-raw-value" class="text-4xl font-extrabold text-green-500"></p>
                        <p class="text-sm font-semibold text-green-600">Năng lượng tiêu thụ/ngày</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12 text-center max-w-3xl mx-auto">
                    <div class="stat-card">
                        <h3 class="text-sm font-medium text-gray-500">Năng lượng mục tiêu/ngày</h3>
                        <p id="tdee-value" class="text-4xl font-extrabold text-lime-600"></p>
                        <p id="tdee-goal" class="text-sm font-semibold text-lime-700"></p>
                    </div>
                    <div class="stat-card">
                        <h3 class="text-sm font-medium text-gray-500">Mục tiêu</h3>
                        <p id="goal-display" class="text-4xl font-extrabold text-teal-500"></p>
                        <p class="text-sm font-semibold text-teal-600">Dựa trên lựa chọn của bạn</p>
                    </div>
                </div>

                 <div class="bg-white/80 backdrop-blur-sm p-6 rounded-xl shadow-lg mb-12 border">
                    <h3 class="text-2xl font-bold text-center mb-4">Phân Bổ Dinh Dưỡng Đa Lượng (Ước Tính)</h3>
                    <div class="chart-container">
                        <canvas id="macro-chart"></canvas>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <div id="breakfast-card" class="result-card flex flex-col p-6">
                        <h3 class="text-2xl font-bold text-center text-orange-500 mb-4">🍳 BỮA SÁNG KHỞI ĐỘNG</h3>
                        <div class="flex-grow">
                            <p class="font-semibold">Món chính: <span id="breakfast-main"></span></p>
                            <p class="text-sm text-gray-600 mb-2" id="breakfast-main-desc"></p>
                            <p class="font-semibold">Thức uống: <span id="breakfast-drink"></span></p>
                            <p class="text-sm text-gray-600 mb-4" id="breakfast-drink-desc"></p>
                            <table class="w-full text-sm mb-4">
                                <caption class="font-semibold mb-2 text-left">Phân Tích Dinh Dưỡng</caption>
                                <tbody>
                                    <tr class="border-b"><td class="py-1">Năng lượng</td><td class="text-right font-medium" id="breakfast-kcal"></td></tr>
                                    <tr class="border-b"><td class="py-1">Protein</td><td class="text-right font-medium" id="breakfast-protein"></td></tr>
                                    <tr class="border-b"><td class="py-1">Chất béo</td><td class="text-right font-medium" id="breakfast-fat"></td></tr>
                                    <tr><td class="py-1">Carbohydrate</td><td class="text-right font-medium" id="breakfast-carbs"></td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bg-yellow-100 border-l-4 border-yellow-400 p-3 rounded mt-auto">
                            <p class="font-semibold">💡 Lời khuyên:</p>
                            <p class="text-sm" id="breakfast-tip"></p>
                        </div>
                    </div>

                    <div id="lunch-card" class="result-card flex flex-col p-6">
                        <h3 class="text-2xl font-bold text-center text-teal-500 mb-4">🍚 BỮA TRƯA CÂN BẰNG</h3>
                        <div class="flex-grow">
                            <p class="font-semibold">Thực đơn: <span id="lunch-main"></span></p>
                            <p class="text-sm text-gray-600 mb-4" id="lunch-main-desc"></p>
                            <table class="w-full text-sm mb-4">
                                <caption class="font-semibold mb-2 text-left">Phân Tích Dinh Dưỡng</caption>
                                <tbody>
                                    <tr class="border-b"><td class="py-1">Năng lượng</td><td class="text-right font-medium" id="lunch-kcal"></td></tr>
                                    <tr class="border-b"><td class="py-1">Protein</td><td class="text-right font-medium" id="lunch-protein"></td></tr>
                                    <tr class="border-b"><td class="py-1">Chất béo</td><td class="text-right font-medium" id="lunch-fat"></td></tr>
                                    <tr><td class="py-1">Carbohydrate</td><td class="text-right font-medium" id="lunch-carbs"></td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bg-teal-50 border-l-4 border-teal-400 p-3 rounded mt-auto">
                            <p class="font-semibold">💡 Lời khuyên:</p>
                            <p class="text-sm" id="lunch-tip"></p>
                        </div>
                    </div>

                    <div id="dinner-card" class="result-card flex flex-col p-6">
                        <h3 class="text-2xl font-bold text-center text-pink-500 mb-4">🥗 BỮA TỐI NHẸ NHÀNG</h3>
                        <div class="flex-grow">
                             <p class="font-semibold">Món chính: <span id="dinner-main"></span></p>
                            <p class="text-sm text-gray-600 mb-2" id="dinner-main-desc"></p>
                            <p class="font-semibold">Thức uống: <span id="dinner-drink"></span></p>
                            <p class="text-sm text-gray-600 mb-4" id="dinner-drink-desc"></p>
                            <table class="w-full text-sm mb-4">
                                <caption class="font-semibold mb-2 text-left">Phân Tích Dinh Dưỡng</caption>
                                <tbody>
                                    <tr class="border-b"><td class="py-1">Năng lượng</td><td class="text-right font-medium" id="dinner-kcal"></td></tr>
                                    <tr class="border-b"><td class="py-1">Protein</td><td class="text-right font-medium" id="dinner-protein"></td></tr>
                                    <tr class="border-b"><td class="py-1">Chất béo</td><td class="text-right font-medium" id="dinner-fat"></td></tr>
                                    <tr><td class="py-1">Carbohydrate</td><td class="text-right font-medium" id="dinner-carbs"></td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bg-pink-50 border-l-4 border-pink-400 p-3 rounded mt-auto">
                            <p class="font-semibold">💡 Lời khuyên:</p>
                            <p class="text-sm" id="dinner-tip"></p>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-6 mt-8">
        <p class="text-sm text-gray-600 bg-white/50 inline-block px-4 py-2 rounded-full">&copy; 2025 Trợ lý dinh dưỡng Algo. Mọi thông tin chỉ mang tính chất tham khảo.</p>
    </footer>

    <script>
        document.getElementById('nutrition-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const age = parseInt(document.getElementById('age').value);
            const gender = document.getElementById('gender').value;
            const height = parseInt(document.getElementById('height').value);
            const weight = parseInt(document.getElementById('weight').value);
            const activityFactor = parseFloat(document.getElementById('activity').value);
            const goal = document.getElementById('goal').value;

            if (isNaN(age) || isNaN(height) || isNaN(weight) || age <= 0 || height <= 0 || weight <= 0) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white p-6 rounded-lg shadow-xl text-center max-w-sm mx-4">
                        <p class="text-lg font-semibold mb-4">Lỗi Dữ Liệu</p>
                        <p class="mb-4">Vui lòng nhập đầy đủ và chính xác các thông tin.</p>
                        <button onclick="this.parentElement.parentElement.remove()" class="btn-primary">Đã hiểu</button>
                    </div>
                `;
                document.body.appendChild(modal);
                return;
            }

            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);

            let bmr;
            if (gender === 'male') {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
            } else {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
            }

            const tdee = bmr * activityFactor;

            let targetCalories;
            let goalText = '';
            let tdeeGoalText = '';

            if (goal === 'lose') {
                targetCalories = tdee - 400;
                goalText = 'Giảm cân';
                tdeeGoalText = 'Để giảm cân';
            } else if (goal === 'gain') {
                targetCalories = tdee + 400;
                goalText = 'Tăng cân';
                tdeeGoalText = 'Để tăng cân';
            } else {
                targetCalories = tdee;
                goalText = 'Duy trì cân nặng';
                tdeeGoalText = 'Để duy trì cân nặng';
            }
            
            let bmiCategory = '';
            if (bmi < 18.5) {
                bmiCategory = 'Thiếu cân';
            } else if (bmi >= 18.5 && bmi < 23) {
                bmiCategory = 'Bình thường';
            } else if (bmi >= 23 && bmi < 25) {
                bmiCategory = 'Thừa cân';
            } else {
                bmiCategory = 'Béo phì';
            }

            document.getElementById('bmi-value').textContent = bmi.toFixed(1);
            document.getElementById('bmi-category').textContent = bmiCategory;
            document.getElementById('tdee-value').textContent = Math.round(targetCalories) + ' kcal';
            document.getElementById('tdee-goal').textContent = tdeeGoalText;
            document.getElementById('goal-display').textContent = goalText;

            let resultIntro = `Chỉ số BMI của bạn là ${bmi.toFixed(1)} (${bmiCategory}). Kế hoạch dưới đây được thiết kế để cung cấp khoảng ${Math.round(targetCalories)} kcal mỗi ngày nhằm hỗ trợ mục tiêu ${goalText.toLowerCase()} của bạn.`;
            document.getElementById('result-intro').textContent = resultIntro;
            
            document.getElementById('bmr-value').textContent = Math.round(bmr) + ' kcal';
            document.getElementById('tdee-raw-value').textContent = Math.round(tdee) + ' kcal';

            const mealPlan = getMealPlan(goal);
            populateMealCards(mealPlan);

            const totalProtein = mealPlan.breakfast.protein + mealPlan.lunch.protein + mealPlan.dinner.protein;
            const totalFat = mealPlan.breakfast.fat + mealPlan.lunch.fat + mealPlan.dinner.fat;
            const totalCarbs = mealPlan.breakfast.carbs + mealPlan.lunch.carbs + mealPlan.dinner.carbs;
            
            drawMacroChart(totalProtein, totalFat, totalCarbs);

            document.getElementById('results-section').classList.remove('hidden');
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        });

        function getMealPlan(goal) {
            const plans = {
                lose: {
                    breakfast: {
                        main: "Phở Gà Gạo Lứt (1 tô vừa)",
                        main_desc: "Bánh phở gạo lứt cung cấp tinh bột phức, giúp no lâu. Thịt ức gà là nguồn protein nạc, ít béo.",
                        drink: "Nước ấm với chanh",
                        drink_desc: "Bắt đầu ngày mới bằng việc bù nước, hỗ trợ tiêu hóa và cung cấp vitamin C.",
                        kcal: 510, protein: 35, fat: 12, carbs: 65,
                        tip: "Hãy thêm nhiều giá đỗ và rau thơm. Hạn chế sử dụng tương đen, tương ớt công nghiệp để giảm lượng đường và muối.",
                    },
                    lunch: {
                        main: "Cơm gạo lứt, Cá diêu hồng hấp gừng, Canh bí đỏ tôm",
                        main_desc: "Bữa trưa cân bằng với protein từ cá, carb phức từ gạo lứt và vitamin từ rau củ.",
                        kcal: 690, protein: 45, fat: 20, carbs: 80,
                        tip: "Nên ăn rau trước để tạo cảm giác no và làm chậm quá trình hấp thụ đường từ cơm.",
                    },
                    dinner: {
                        main: "Ức gà áp chảo & Khoai lang luộc",
                        main_desc: "Ức gà cung cấp protein tinh khiết. Khoai lang là nguồn carb tốt với chỉ số GI thấp.",
                        drink: "Salad rau xanh sốt chanh dây",
                        drink_desc: "Bổ sung vitamin, khoáng chất và enzyme tươi sống từ rau củ.",
                        kcal: 490, protein: 40, fat: 15, carbs: 50,
                        tip: "Nên ăn tối trước giờ đi ngủ ít nhất 3 tiếng để hệ tiêu hóa hoạt động tốt nhất.",
                    }
                },
                maintain: {
                    breakfast: {
                        main: "Bún bò Huế (1 tô vừa)",
                        main_desc: "Cung cấp năng lượng dồi dào từ bún và protein từ thịt bò, chả.",
                        drink: "Trà Atiso",
                        drink_desc: "Hỗ trợ giải nhiệt và tốt cho gan.",
                        kcal: 550, protein: 30, fat: 20, carbs: 60,
                        tip: "Yêu cầu ít sa tế và vắt thêm chanh để cân bằng vị và tăng vitamin C.",
                    },
                    lunch: {
                        main: "Cơm trắng, Thịt kho trứng, Canh chua cá lóc, Rau muống xào tỏi",
                        main_desc: "Một bữa cơm truyền thống Việt Nam, đầy đủ các nhóm chất dinh dưỡng.",
                        kcal: 750, protein: 40, fat: 25, carbs: 90,
                        tip: "Hạn chế chan quá nhiều nước thịt kho để giảm lượng natri và chất béo bão hòa.",
                    },
                    dinner: {
                        main: "Miến gà",
                        main_desc: "Một lựa chọn nhẹ nhàng nhưng vẫn đủ chất cho bữa tối.",
                        drink: "Nước ép táo",
                        drink_desc: "Cung cấp vitamin và chất xơ tự nhiên.",
                        kcal: 500, protein: 35, fat: 15, carbs: 55,
                        tip: "Thêm nhiều giá và rau răm để tăng hương vị và dinh dưỡng.",
                    }
                },
                gain: {
                    breakfast: {
                        main: "Xôi mặn thập cẩm",
                        main_desc: "Nguồn năng lượng cao từ gạo nếp, kết hợp protein từ chả, lạp xưởng, trứng cút.",
                        drink: "Sữa đậu nành",
                        drink_desc: "Bổ sung protein thực vật và các axit amin cần thiết.",
                        kcal: 650, protein: 35, fat: 25, carbs: 70,
                        tip: "Thêm một quả trứng ốp la để tăng cường protein và chất béo lành mạnh.",
                    },
                    lunch: {
                        main: "Cơm sườn bì chả, Canh khổ qua dồn thịt",
                        main_desc: "Bữa trưa giàu năng lượng và protein từ sườn nướng, chả trứng và thịt dồn.",
                        kcal: 850, protein: 50, fat: 30, carbs: 95,
                        tip: "Nên ăn thêm dưa leo, cà chua để cân bằng và bổ sung vitamin.",
                    },
                    dinner: {
                        main: "Bò bít tết và khoai tây nghiền",
                        main_desc: "Thịt bò cung cấp lượng lớn protein và sắt, giúp xây dựng cơ bắp hiệu quả.",
                        drink: "Sinh tố bơ",
                        drink_desc: "Cung cấp chất béo tốt, vitamin và khoáng chất.",
                        kcal: 700, protein: 45, fat: 35, carbs: 50,
                        tip: "Thêm một phần bông cải xanh luộc để đảm bảo lượng chất xơ cần thiết.",
                    }
                }
            };
            
            return plans[goal] || plans.maintain;
        }
        
        function populateMealCards(plan) {
            document.getElementById('breakfast-main').textContent = plan.breakfast.main;
            document.getElementById('breakfast-main-desc').textContent = plan.breakfast.main_desc;
            document.getElementById('breakfast-drink').textContent = plan.breakfast.drink;
            document.getElementById('breakfast-drink-desc').textContent = plan.breakfast.drink_desc;
            document.getElementById('breakfast-kcal').textContent = plan.breakfast.kcal + ' kcal';
            document.getElementById('breakfast-protein').textContent = plan.breakfast.protein + ' g';
            document.getElementById('breakfast-fat').textContent = plan.breakfast.fat + ' g';
            document.getElementById('breakfast-carbs').textContent = plan.breakfast.carbs + ' g';
            document.getElementById('breakfast-tip').textContent = plan.breakfast.tip;

            document.getElementById('lunch-main').textContent = plan.lunch.main;
            document.getElementById('lunch-main-desc').textContent = plan.lunch.main_desc;
            document.getElementById('lunch-kcal').textContent = plan.lunch.kcal + ' kcal';
            document.getElementById('lunch-protein').textContent = plan.lunch.protein + ' g';
            document.getElementById('lunch-fat').textContent = plan.lunch.fat + ' g';
            document.getElementById('lunch-carbs').textContent = plan.lunch.carbs + ' g';
            document.getElementById('lunch-tip').textContent = plan.lunch.tip;
            
            document.getElementById('dinner-main').textContent = plan.dinner.main;
            document.getElementById('dinner-main-desc').textContent = plan.dinner.main_desc;
            document.getElementById('dinner-drink').textContent = plan.dinner.drink;
            document.getElementById('dinner-drink-desc').textContent = plan.dinner.drink_desc;
            document.getElementById('dinner-kcal').textContent = plan.dinner.kcal + ' kcal';
            document.getElementById('dinner-protein').textContent = plan.dinner.protein + ' g';
            document.getElementById('dinner-fat').textContent = plan.dinner.fat + ' g';
            document.getElementById('dinner-carbs').textContent = plan.dinner.carbs + ' g';
            document.getElementById('dinner-tip').textContent = plan.dinner.tip;
        }

        let macroChart = null;
        function drawMacroChart(protein, fat, carbs) {
            const ctx = document.getElementById('macro-chart').getContext('2d');
            const totalCalories = protein * 4 + fat * 9 + carbs * 4;
            if (macroChart) {
                macroChart.destroy();
            }
            macroChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Protein', 'Chất béo', 'Carbohydrate'],
                    datasets: [{
                        data: [
                            (protein * 4 * 100 / totalCalories).toFixed(1), 
                            (fat * 9 * 100 / totalCalories).toFixed(1), 
                            (carbs * 4 * 100 / totalCalories).toFixed(1)
                        ],
                        backgroundColor: ['#22D3EE', '#F97316', '#84CC16'],
                        borderColor: '#FFFFFF',
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { size: 14 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    } else {
                                      return label;
                                    }
                                },
                                label: function(context) {
                                    return ' ' + context.formattedValue + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>

</body>
</html>


